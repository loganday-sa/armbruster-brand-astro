---
interface Props {
	currentPage: number;
	totalPages: number;
	baseUrl: string;
}

const { currentPage, totalPages, baseUrl } = Astro.props;

function getPageNumbers(current: number, total: number): (number | '...')[] {
	if (total <= 7) {
		return Array.from({ length: total }, (_, i) => i + 1);
	}

	const pages: (number | '...')[] = [];
	pages.push(1);

	if (current > 3) {
		pages.push('...');
	}

	const start = Math.max(2, current - 1);
	const end = Math.min(total - 1, current + 1);

	for (let i = start; i <= end; i++) {
		pages.push(i);
	}

	if (current < total - 2) {
		pages.push('...');
	}

	if (total > 1) {
		pages.push(total);
	}

	return pages;
}

const pageNumbers = getPageNumbers(currentPage, totalPages);

function getPageUrl(page: number): string {
	if (page === 1) {
		return baseUrl;
	}
	return `${baseUrl}${page}/`;
}
---

{totalPages > 1 && (
	<nav class="flex justify-center items-center gap-2 mt-12 py-4" aria-label="Pagination">
		{currentPage > 1 ? (
			<a
				href={getPageUrl(currentPage - 1)}
				class="inline-flex items-center gap-1 px-4 py-2 rounded-lg text-sm font-medium text-slate-300 bg-slate-900 border border-slate-800 hover:border-blue-500 hover:text-white transition"
				aria-label="Previous page"
			>
				<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
					<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
				</svg>
				Previous
			</a>
		) : (
			<span class="inline-flex items-center gap-1 px-4 py-2 rounded-lg text-sm font-medium text-slate-600 bg-slate-900 border border-slate-800 cursor-not-allowed">
				<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
					<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
				</svg>
				Previous
			</span>
		)}

		<div class="flex gap-1">
			{pageNumbers.map((page) =>
				page === '...' ? (
					<span class="inline-flex items-center justify-center w-10 h-10 text-slate-500">...</span>
				) : (
					<a
						href={getPageUrl(page)}
						class:list={[
							'inline-flex items-center justify-center w-10 h-10 rounded-lg text-sm font-medium transition',
							page === currentPage
								? 'bg-blue-600 text-white'
								: 'text-slate-300 bg-slate-900 border border-slate-800 hover:border-slate-700 hover:text-white',
						]}
						aria-current={page === currentPage ? 'page' : undefined}
					>
						{page}
					</a>
				)
			)}
		</div>

		{currentPage < totalPages ? (
			<a
				href={getPageUrl(currentPage + 1)}
				class="inline-flex items-center gap-1 px-4 py-2 rounded-lg text-sm font-medium text-slate-300 bg-slate-900 border border-slate-800 hover:border-blue-500 hover:text-white transition"
				aria-label="Next page"
			>
				Next
				<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
					<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
				</svg>
			</a>
		) : (
			<span class="inline-flex items-center gap-1 px-4 py-2 rounded-lg text-sm font-medium text-slate-600 bg-slate-900 border border-slate-800 cursor-not-allowed">
				Next
				<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
					<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
				</svg>
			</span>
		)}
	</nav>
)}
